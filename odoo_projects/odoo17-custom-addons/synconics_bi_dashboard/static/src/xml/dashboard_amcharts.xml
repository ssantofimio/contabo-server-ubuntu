<?xml version="1.0" encoding="utf-8"?>

<templates xml:space="preserve">
    <t t-name="synconics_bi_dashboard.DashboardAmcharts">
        <div class="o_action o_synconics_bi_dashboard h-100 d-flex flex-column">
        <section class="o_cp_top d-flex align-items-center justify-content-between" style="height: 50px; background: white; border-bottom: 1px #dfdfdff5 solid; padding: 0 15px;">
            <div class="left-panel d-flex gap-2 align-items-center">
                <h3 class="mb-0 me-3 ms-3"><strong t-out="state.name"></strong></h3>
                <button t-if="!state.editMode &amp;&amp; state.charts.length" class="btn btn-secondary" title="Print" t-on-click="onPrintDashboard">
                    <i class="fa fa-print" />
                </button>
                <button t-if="!state.editMode &amp;&amp; state.charts.length" class="btn btn-secondary" title="Download JSON" t-on-click="export_json">
                    <i class="fa fa-download" />
                </button>
                <input type="file" accept=".json" t-ref="fileInput" style="display:none" t-on-change="onFileChange"/>
                <button  t-if="!state.editMode &amp;&amp; !state.charts.length" class="btn btn-secondary" type="button" title="Upload JSON" t-on-click="onUploadClick">
                    <i class="fa fa-upload" />
                </button>
                <button t-if="!state.editMode &amp;&amp; state.charts.length &amp;&amp; !dashboard_user" class="btn btn-secondary" title="Send by Email" t-on-click="onSendEmail">
                    <i class="fa fa-envelope" />
                </button>
                <button class="btn btn-secondary" t-if="state.editMode" t-on-click="onEditDiscard" title="Discard">
                    <i class="fa fa-close" />
                </button>
                <button class="btn btn-secondary" t-if="state.charts.length &amp;&amp; !dashboard_user" t-on-click="onEditLayout" title="Edit Layout">
                    <t t-if="state.editMode">
                        <i class="fa fa-cloud-download" />
                    </t>
                    <t t-else="">
                        <i class="fa fa-pencil" />
                    </t>
                </button>
            </div>
            <div class="right-panel d-flex justify-content-end">
                <button t-if="!state.editMode &amp;&amp; !dashboard_user" class="btn btn-primary" t-on-click="onAddLayout">
                    Add new Layout
                </button>
            </div>
        </section>
        <main class="o_content flex-grow-1 overflow-auto" style="padding: 10px;">
            <div class="h-100">
                <div class="grid-stack m-0" gs-column="12">
                     <!-- style="max-height: 84vh; overflow: auto;" -->
                    <t t-foreach="state.charts" t-as="chart" t-key="chart.id">
                        <div class="grid-stack-item m-1" t-att-data-chart-id="chart.id" t-att-gs-w="chart.w" t-att-gs-h="chart.h" t-att-gs-min-h="chart.minh" t-att-gs-x="chart.x" t-att-gs-y="chart.y">
                            <DashboardChartWrapper editChart="editChart" theme="chart.theme" onUpdateExport="onUpdateExport" reloadKey="reloadKey.value" chart_type="chart.chart_type" chartId="chart.id" name="chart.name" recordSets="chart.recordset" background_color="chart.background_color" dashboard_user="dashboard_user"/>
                        </div>
                    </t>
                </div>
            </div>
        </main>
        </div>
    </t>
</templates>
