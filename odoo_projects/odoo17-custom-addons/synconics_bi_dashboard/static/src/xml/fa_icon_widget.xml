<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <!-- Main Field Template -->
    <t t-name="fa_icon_widget.FaIconField" owl="1">
        <div class="o_field_fa_icon" t-att-class="{'o_field_readonly': props.readonly}">
            <!-- Display the selected icon -->
            <t t-set="html_icon" t-value="iconHtml()" />
            <div class="o_field_fa_icon_preview" t-if="props.value">
                <!-- <span t-if="iconClass" t-att-class="iconClass + ' fa-2x'"></span> -->
                <span t-out="html_icon"></span>
            </div>

            <!-- Edit mode controls -->
            <!-- <t t-if="!props.readonly">
                <div class="o_field_fa_icon_controls">
                    <button class="btn btn-secondary btn-sm me-1" t-on-click="openIconDialog">
                        <i class="fa fa-pencil me-1"></i>Select Icon
                    </button>
                    <button t-if="props.value" class="btn btn-light btn-sm" t-on-click="clearIcon">
                        <i class="fa fa-times me-1"></i>Clear
                    </button>
                </div>
            </t> -->
        </div>

        <div class="o_field_image" aria-atomic="true">
            <t t-if="props.mode !== 'readonly'">
                <div class="o_form_image_controls">
                    <button class="fa fa-pencil fa-lg float-left fieldIconSelect" t-on-click="openIconDialog" title="Edit" aria-label="Edit"/>
                    <button class="fa fa-trash-o fa-lg float-right o_clear_file_button" t-on-click="clearIcon" title="Clear" aria-label="Clear"/>
                    <!-- <span class="o_form_binary_progress">Uploading...</span> -->
                </div>
            </t>
        </div>
    </t>

    <!-- Icon Selection Dialog Template -->
    <t t-name="fa_icon_widget.IconSelectionDialog" owl="1">
        <Dialog title="'Select FontAwesome Icon'" size="'xl'">
            <div class="o_fa_icon_selection_dialog">
                <!-- Search bar -->
                <div class="o_fa_icon_search mb-3">
                    <div class="input-group">
                        <input
                            type="search"
                            class="form-control"
                            placeholder="Search icons or enter custom icon name (e.g. 'home' or 'fa fa-home')"
                            t-on-input="onSearch"
                            t-ref="searchInput"
                        />
                        <button class="btn btn-primary" t-on-click="onAddCustomIcon">
                            <i class="fa fa-plus me-1"></i>Add Custom
                        </button>
                    </div>
                    <small class="form-text text-muted">
                        For more icons, refer to <a href="https://fontawesome.com/v4/icons/" target="_blank">FontAwesome v4 Icons</a>
                    </small>
                </div>

                <div class="o_fa_icon_grid" style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr 1fr;">
                    <t t-foreach="state.filteredIcons" t-as="icon" t-key="icon">
                        <div
                            class="o_fa_icon_item"
                            t-att-class="{'o_fa_icon_selected': state.selectedIcon === icon}"
                            t-on-click="() => this.onIconClick(icon)"
                        >
                            <i t-attf-class="fa fa-{{icon}} fa-2x"></i>
                            <div class="o_fa_icon_name">
                                <small t-out="icon"></small>
                            </div>
                        </div>
                    </t>
                    <t t-if="state.filteredIcons.length === 0">
                        <div class="alert alert-info w-100 text-center">
                            No icons found matching your search. You can add a custom icon using the "Add Custom" button.
                        </div>
                    </t>
                </div>
            </div>
            <t t-set-slot="footer">
                <button class="btn btn-primary" t-on-click="onSelectClick" t-att-disabled="!state.selectedIcon">
                    Select
                </button>
                <button class="btn btn-secondary" t-on-click="props.close">
                    Cancel
                </button>
            </t>
        </Dialog>
    </t>
</templates>
