<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_stock_report_balance_tree" model="ir.ui.view">
        <field name="name">stock.report.balance.tree</field>
        <field name="model">stock.report.balance</field>
        <field name="arch" type="xml">
            <list string="Balance de Inventario (Kardex)" create="0" edit="0" delete="0">
                <field name="warehouse_id" optional="show"/>
                <field name="date_from" optional="show"/>
                <field name="date_to" optional="show"/>
                <field name="product_categ_id" optional="show"/>
                <field name="product_id" options="{'no_open': True}"/>
                <field name="product_uom_id" string="UdM" groups="uom.group_uom"/>
                <field name="currency_id" column_invisible="True"/>
                
                <!-- Cantidades -->
                <field name="qty_initial" string="Stock Inic." sum="Total Inic."/>
                <field name="qty_in" string="Entradas" sum="Total Entradas"/>
                <field name="qty_out" string="Salidas" sum="Total Salidas"/>
                <field name="qty_final" string="Stock Final" sum="Total Final"/>
                
                <!-- Valores -->
                <field name="val_initial" string="Valor Inic." sum="Total Valor Inic." widget="monetary"/>
                <field name="val_in" string="Valor Entradas" sum="Total Valor Entradas" widget="monetary"/>
                <field name="val_out" string="Valor Salidas" sum="Total Valor Salidas" widget="monetary"/>
                <field name="val_final" string="Valor Final" sum="Total Valor Final" widget="monetary"/>
            </list>
        </field>
    </record>

    <record id="view_stock_report_balance_form" model="ir.ui.view">
        <field name="name">stock.report.balance.form</field>
        <field name="model">stock.report.balance</field>
        <field name="arch" type="xml">
            <form string="Detalle de Kardex" create="0" edit="0" delete="0">
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="product_id" readonly="1"/>
                        </h1>
                        <h3>
                            <field name="warehouse_id" readonly="1"/>
                        </h3>
                    </div>
                    <group>
                        <group name="periodo" string="Periodo Consultado">
                            <field name="date_from" readonly="1"/>
                            <field name="date_to" readonly="1"/>
                        </group>
                        <group name="resumen" string="Resumen de Stock">
                            <field name="qty_initial" string="Stock Inicial" readonly="1"/>
                            <field name="qty_final" string="Stock Final" readonly="1"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Historial de Movimientos" name="move_lines">
                            <field name="move_line_ids" readonly="1">
                                <list string="Movimientos" decoration-info="location_dest_id != False" no_open="1">
                                    <field name="location_usage" column_invisible="True"/>
                                    <field name="location_dest_usage" column_invisible="True"/>
                                    <field name="date" string="Fecha"/>
                                    <field name="reference" string="Referencia"/>
                                    <field name="product_id" optional="hide" options="{'no_open': True}"/>
                                    <field name="lot_id" string="NÃºmero de serie/lote" optional="show" options="{'no_open': True}"/>
                                    <field name="location_id" string="Desde" options="{'no_open': True}"/>
                                    <field name="location_dest_id" string="A" options="{'no_open': True}"/>
                                    <field name="quantity" string="Cantidad" sum="Total"
                                           decoration-danger="(location_usage in ('internal','transit')) and (location_dest_usage not in ('internal','transit'))"
                                           decoration-success="(location_usage not in ('internal','transit')) and (location_dest_usage in ('internal','transit'))"/>
                                    <field name="product_uom_id" string="Unid." groups="uom.group_uom" options="{'no_open': True}"/>
                                    <field name="state" string="Estado" widget="badge" decoration-success="state == 'done'" decoration-info="state not in ('done', 'cancel')"/>
                                </list>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="view_stock_report_balance_pivot" model="ir.ui.view">
        <field name="name">stock.report.balance.pivot</field>
        <field name="model">stock.report.balance</field>
        <field name="arch" type="xml">
            <pivot string="Balance de Inventario" sample="1">
                <field name="product_categ_id" type="row"/>
                <field name="product_id" type="row"/>
                <field name="qty_initial" type="measure"/>
                <field name="qty_in" type="measure"/>
                <field name="qty_out" type="measure"/>
                <field name="qty_final" type="measure"/>
                <field name="val_final" type="measure"/>
            </pivot>
        </field>
    </record>
</odoo>
